#!/bin/bash

if [ ! -f /usr/local/bin/answer.txt ]; then
    fail-message "You haven't answered yet! You must run the \"answer\" command and press ENTER"
    exit 1
fi

ANSWER=$(cat /usr/local/bin/answer.txt)

CORRECT=$(bq query --format=prettyjson 'SELECT name, SUM(number) AS count FROM `bigquery-public-data.usa_names.usa_1910_current` GROUP BY 1 ORDER BY 2 DESC LIMIT 1' | jq -r ".[] .name | ascii_downcase")

if [[ "$CORRECT" != "$ANSWER" ]]; then
    fail-message "Your answer is incorrect! Try running the following query SELECT name, SUM(number) FROM \`bigquery-public-data.usa_names.usa_1910_current\` GROUP BY 1 ORDER BY 2 DESC LIMIT 1"
    exit 1
fi
